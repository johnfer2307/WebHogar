<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario de Aseo del Hogar 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .task-tag {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-bottom: 3px;
            display: block;
            line-height: 1.2;
            font-weight: 500;
        }
        .user-johncito { background-color: #dbeafe; color: #1e40af; border-left: 3px solid #1e40af; }
        .user-prespos { background-color: #fef3c7; color: #92400e; border-left: 3px solid #92400e; }
        .user-katherin { background-color: #fce7f3; color: #9d174d; border-left: 3px solid #9d174d; }
        .user-shared { background-color: #f3f4f6; color: #374151; border-left: 3px solid #9ca3af; }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e5e7eb;
        }
        .day-cell {
            background-color: white;
            min-height: 140px;
            padding: 10px;
            transition: background-color 0.2s;
        }
        .day-cell:hover { background-color: #f9fafb; }
        .holiday-bg { background-color: #fff1f2; }
        .weekend-bg { background-color: #f8fafc; }
        
        @media (max-width: 1024px) {
            .calendar-grid { grid-template-columns: repeat(2, 1fr); }
            .day-cell { min-height: auto; }
        }
        @media (max-width: 640px) {
            .calendar-grid { grid-template-columns: 1fr; }
        }

        .view-btn-active {
            background-color: #334155;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
        <!-- HEADER -->
        <div class="bg-slate-800 p-6 text-white">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                <div>
                    <h1 class="text-3xl font-bold tracking-tight">Calendario de Aseo del Hogar</h1>
                    <p class="text-slate-400 mt-1">Organizaci√≥n din√°mica de responsabilidades 2026</p>
                </div>
                
                <div class="flex flex-col items-center gap-3">
                    <div class="flex bg-slate-700 p-1 rounded-lg text-xs font-bold">
                        <button id="btnMonthView" onclick="setView('month')" class="px-4 py-2 rounded-md transition view-btn-active">MES COMPLETO</button>
                        <button id="btnWeekView" onclick="setView('week')" class="px-4 py-2 rounded-md transition">SEMANAL</button>
                    </div>

                    <div class="flex items-center bg-slate-700 rounded-lg p-1">
                        <button onclick="navigate(-1)" class="p-2 hover:bg-slate-600 rounded-md transition">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                        </button>
                        <span id="displayLabel" class="text-lg font-bold px-6 min-w-[220px] text-center uppercase tracking-widest text-sm md:text-base">Enero 2026</span>
                        <button onclick="navigate(1)" class="p-2 hover:bg-slate-600 rounded-md transition">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- LEYENDA -->
        <div class="px-6 py-4 border-b bg-gray-50 flex flex-wrap gap-6 text-sm font-semibold text-gray-700">
            <div class="flex items-center gap-2"><span class="w-4 h-4 rounded user-johncito"></span> Johncito</div>
            <div class="flex items-center gap-2"><span class="w-4 h-4 rounded user-prespos"></span> Prespos</div>
            <div class="flex items-center gap-2"><span class="w-4 h-4 rounded user-katherin"></span> Katherin</div>
            <div class="flex items-center gap-2"><span class="w-4 h-4 rounded user-shared"></span> General</div>
        </div>

        <!-- CALENDARIO -->
        <div class="p-1">
            <div id="calendarGrid" class="calendar-grid">
                <!-- Inyectado por JS -->
            </div>
        </div>

        <!-- FOOTER -->
        <div class="p-6 bg-slate-50 border-t text-xs text-gray-500 grid md:grid-cols-2 gap-4">
            <div>
                <p><strong>Reglas de Almuerzos Actualizadas (2026):</strong></p>
                <ul class="list-disc ml-4 mt-2 space-y-1">
                    <li><strong>Lunes a Viernes:</strong> Prespos (siempre que no sea festivo).</li>
                    <li><strong>S√°bados, Domingos y Festivos:</strong> Rotaci√≥n estricta entre Johncito y Katherin (Prespos excluido).</li>
                </ul>
            </div>
            <div class="text-right">
                <p>‚ö†Ô∏è Sistema de rotaci√≥n secuencial para equidad en d√≠as especiales.</p>
            </div>
        </div>
    </div>

    <script>
        let currentYear = 2026;
        let currentMonth = 0; 
        let currentWeekIndex = 0; 
        let currentView = 'month'; 

        const persons = ['Johncito', 'Prespos', 'Katherin'];
        const dayNames = ["DOMINGO", "LUNES", "MARTES", "MI√âRCOLES", "JUEVES", "VIERNES", "S√ÅBADO"];
        
        const holidays = [
            '2026-01-01', '2026-01-12', '2026-03-23', '2026-04-02', '2026-04-03', 
            '2026-05-01', '2026-05-18', '2026-06-08', '2026-06-15', '2026-06-29', 
            '2026-07-20', '2026-08-07', '2026-08-17', '2026-10-12', '2026-11-02', 
            '2026-11-16', '2026-12-08', '2026-12-25'
        ];

        function isHoliday(dateStr) { return holidays.includes(dateStr); }

        /**
         * Calcula el √≠ndice de rotaci√≥n para d√≠as especiales (S√°b, Dom y Festivos).
         * Cuenta cu√°ntos de estos d√≠as han pasado desde el inicio del a√±o para alternar entre Johncito y Katherin.
         */
        function getSpecialDayRotation(date) {
            let specialDaysCount = 0;
            let tempDate = new Date(date.getFullYear(), 0, 1);
            
            while (tempDate <= date) {
                const dayOfWeek = tempDate.getDay();
                const dateStr = tempDate.toISOString().split('T')[0];
                const isH = isHoliday(dateStr);
                const isW = (dayOfWeek === 0 || dayOfWeek === 6);

                if (isH || isW) {
                    specialDaysCount++;
                }
                tempDate.setDate(tempDate.getDate() + 1);
            }
            // Retorna 0 (Johncito) o 1 (Katherin) basado en la cuenta secuencial
            return (specialDaysCount - 1) % 2; 
        }

        function setView(view) {
            currentView = view;
            currentWeekIndex = 0;
            document.getElementById('btnMonthView').classList.toggle('view-btn-active', view === 'month');
            document.getElementById('btnWeekView').classList.toggle('view-btn-active', view === 'week');
            renderCalendar();
        }

        function navigate(delta) {
            if (currentView === 'month') {
                currentMonth += delta;
                if (currentMonth > 11) currentMonth = 11;
                if (currentMonth < 0) currentMonth = 0;
            } else {
                const weeks = getWeeksOfMonth(currentYear, currentMonth);
                currentWeekIndex += delta;
                if (currentWeekIndex < 0) {
                    if (currentMonth > 0) {
                        currentMonth--;
                        const prevWeeks = getWeeksOfMonth(currentYear, currentMonth);
                        currentWeekIndex = prevWeeks.length - 1;
                    } else {
                        currentWeekIndex = 0;
                    }
                } else if (currentWeekIndex >= weeks.length) {
                    if (currentMonth < 11) {
                        currentMonth++;
                        currentWeekIndex = 0;
                    } else {
                        currentWeekIndex = weeks.length - 1;
                    }
                }
            }
            renderCalendar();
        }

        function getWeeksOfMonth(year, month) {
            const weeks = [];
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            let startOffset = firstDay.getDay() - 1;
            if (startOffset === -1) startOffset = 6;

            let currentDay = 1;
            let week = new Array(7).fill(null);
            for (let i = startOffset; i < 7; i++) {
                week[i] = currentDay++;
            }
            weeks.push(week);

            while (currentDay <= lastDay.getDate()) {
                week = new Array(7).fill(null);
                for (let i = 0; i < 7 && currentDay <= lastDay.getDate(); i++) {
                    week[i] = currentDay++;
                }
                weeks.push(week);
            }
            return weeks;
        }

        function getDayTasks(d, month, year) {
            if (!d) return '';
            const date = new Date(year, month, d);
            const dayOfWeek = date.getDay();
            const dateStr = date.toISOString().split('T')[0];
            const isH = isHoliday(dateStr);
            const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
            
            const startYear = new Date(year, 0, 1);
            const dayOfYear = Math.floor((date - startYear) / (86400000));
            const weekNum = Math.floor((dayOfYear + (startYear.getDay() || 7) - 1) / 7);

            let tasks = [];

            // --- L√ìGICA DE ALMUERZO ACTUALIZADA ---
            if (!isWeekend && !isH) {
                // Lunes a Viernes (no festivo): Prespos
                tasks.push({ text: 'üç¥ Almuerzo: Prespos', class: 'user-prespos' });
            } else {
                // S√°bados, Domingos o Festivos: Rotaci√≥n entre Johncito y Katherin
                const specialChefIdx = getSpecialDayRotation(date);
                const chefName = (specialChefIdx === 0) ? 'Johncito' : 'Katherin';
                const prefix = isH ? 'üéâ' : 'üç¥';
                tasks.push({ text: `${prefix} Almuerzo: ${chefName}`, class: `user-${chefName.toLowerCase()}` });
            }

            // --- Aseo Diario ---
            const p1 = persons[dayOfYear % 3];
            const p2 = persons[(dayOfYear + 1) % 3];
            const p3 = persons[(dayOfYear + 2) % 3];
            tasks.push({ text: `üßº Desinf. Ba√±os: ${p1}`, class: `user-${p1.toLowerCase()}` });
            tasks.push({ text: `üßπ Barrer/Trapear: ${p2}`, class: `user-${p2.toLowerCase()}` });
            tasks.push({ text: `üóëÔ∏è Basura: ${p3}`, class: `user-${p3.toLowerCase()}` });

            // --- Tareas Especiales Semanales ---
            if (dayOfWeek === 6) {
                const jOrP = (weekNum % 2 === 0) ? 'Johncito' : 'Prespos';
                tasks.push({ text: `üöø Ducha Ppal: ${jOrP}`, class: `user-${jOrP.toLowerCase()}` });
                tasks.push({ text: 'üöø Ducha Social: Katherin', class: 'user-katherin' });
            }

            if (dayOfWeek === 5) {
                const duster = persons[weekNum % 3];
                tasks.push({ text: `‚ú® Sacudir: ${duster}`, class: `user-${duster.toLowerCase()}` });
            }

            if (dayOfWeek === 3 || dayOfWeek === 5) {
                const laundryIdx = Math.floor(dayOfYear / 2.5) % 3; 
                tasks.push({ text: `üß∫ Ropa: ${persons[laundryIdx]}`, class: `user-${persons[laundryIdx].toLowerCase()}` });
            }

            const startCamas = new Date(year, 0, 10);
            const diffDays = Math.floor((date - startCamas) / 86400000);
            if (diffDays >= 0 && diffDays % 15 === 0) {
                tasks.push({ text: 'üõèÔ∏è Cambiar Camas', class: 'user-shared font-bold italic' });
            }

            if (dayOfWeek === 3) tasks.push({ text: '‚òÅÔ∏è Almohadas J & P', class: 'user-shared' });

            return tasks.map(t => `<span class="task-tag ${t.class}">${t.text}</span>`).join('');
        }

        function createDayCell(day, month, year) {
            if (!day) return `<div class="bg-gray-100 hidden lg:block"></div>`;
            
            const date = new Date(year, month, day);
            const isH = isHoliday(date.toISOString().split('T')[0]);
            const isW = (date.getDay() === 0 || date.getDay() === 6);
            const name = dayNames[date.getDay()];
            const tasks = getDayTasks(day, month, year);

            return `
                <div class="day-cell ${isH ? 'holiday-bg' : (isW ? 'weekend-bg' : '')}">
                    <div class="flex flex-col mb-3">
                        <div class="flex items-baseline gap-2">
                            <span class="text-xl font-black ${isH ? 'text-red-600' : 'text-slate-800'}">${day}</span>
                            <span class="text-[10px] font-bold tracking-tighter text-slate-400">${name}</span>
                        </div>
                        ${isH ? '<span class="mt-1 text-[8px] bg-red-600 text-white px-1 py-0.5 rounded w-fit font-black uppercase tracking-tighter">Festivo</span>' : ''}
                    </div>
                    <div class="space-y-1">${tasks}</div>
                </div>
            `;
        }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const display = document.getElementById('displayLabel');
            const months = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            
            grid.innerHTML = '';
            
            if (currentView === 'month') {
                display.innerText = `${months[currentMonth]} ${currentYear}`;
                const firstDay = new Date(currentYear, currentMonth, 1);
                const lastDay = new Date(currentYear, currentMonth + 1, 0);
                let startOffset = firstDay.getDay() - 1;
                if (startOffset === -1) startOffset = 6;

                for (let i = 0; i < startOffset; i++) grid.innerHTML += createDayCell(null);

                for (let d = 1; d <= lastDay.getDate(); d++) {
                    grid.innerHTML += createDayCell(d, currentMonth, currentYear);
                }
            } else {
                const weeks = getWeeksOfMonth(currentYear, currentMonth);
                display.innerText = `${months[currentMonth]} - SEMANA ${currentWeekIndex + 1}`;
                const week = weeks[currentWeekIndex];
                week.forEach(d => {
                    grid.innerHTML += createDayCell(d, currentMonth, currentYear);
                });
            }
        }

        window.onload = renderCalendar;
    </script>
</body>
</html>
</html>
